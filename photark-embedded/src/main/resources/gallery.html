<!--
    * Licensed to the Apache Software Foundation (ASF) under one
    * or more contributor license agreements.  See the NOTICE file
    * distributed with this work for additional information
    * regarding copyright ownership.  The ASF licenses this file
    * to you under the Apache License, Version 2.0 (the
    * "License"); you may not use this file except in compliance
    * with the License.  You may obtain a copy of the License at
    *
    *   http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing,
    * software distributed under the License is distributed on an
    * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    * KIND, either express or implied.  See the License for the
    * specific language governing permissions and limitations
    * under the License.
-->
<html>
<head>
<title>Photo Gallery</title>

<link href="styles.css" rel="stylesheet">

<script type="text/javascript" src="gallery.js"></script>
<script language="JavaScript">

	//@Reference
	var gallery = new tuscany.sca.Reference("gallery");

	var galleryName;
	var galleryAlbums;

	function gallery_getAlbumsResponse(albums, exception) {
		if(exception) {
			alert(exception.msg);
			return;
		}
		galleryAlbums = albums;

		if(galleryAlbums.length > 0) {
		    showGallery();
		}
	}

	function showGallery() {
		var table=document.getElementById('tableGallery');
		var lastRow = table.rows.length;
		for(i=0; i<galleryAlbums.length; i++) {
			   var row=table.insertRow(lastRow++);
			   var column=row.insertCell(0);

			   var albumName = galleryAlbums[i].name;
			   var albumCover = gallery.getAlbumCover(albumName);
			   var img_src = albumCover;
			   var html = "<img src=" + "gallery/" + albumName + "/" + img_src + " class=\"slideImage\" height=25% width=25% ondragstart=\"return false\" onselectstart=\"return false\" oncontextmenu=\"return false\" galleryimg=\"no\" usemap=\"#imagemap\" alt=\"\"/>";
			   column.innerHTML = html;

			   row = table.insertRow(lastRow++);
			   column = row.insertCell(0)
			   column.innerHTML = albumName;

			   row = table.insertRow(lastRow++);
			   column = row.insertCell(0)
			   column.innerHTML = "<img src=\"space.gif\" class=\"slideImage\" width=\"10\" height=\"10\" ondragstart=\"return false\" onselectstart=\"return false\" oncontextmenu=\"return false\" galleryimg=\"no\" usemap=\"#imagemap\" alt=\"\">";
		   }

	}

	function showImage(pos) {
	   	var img = document.createElement("img");
		img.onload = function(evt) {
			document.getElementById("albumImage").src = this.src;
	        document.getElementById("albumImage").width=this.width;
	        document.getElementById("albumImage").height=this.height;
	    }
	    img.src = albumItems[pos];
	    return false;
	   }
		


	function init() {
		try {
			gallery.getAlbums(gallery_getAlbumsResponse);
		} catch(exception) {
			alert(e);
		}
	}

</script>

</head>

<body onload="init()">
<br>
<h1><center>Apache PhotArk Gallery</center></h1>
<br>
<br>
  <div id="gallery">
     <center>
     <table id="tableGallery" style="width:720px;" border="0" cellspacing="0" cellpadding="1"/>
     </center>
  </div>
</body>
</html>
